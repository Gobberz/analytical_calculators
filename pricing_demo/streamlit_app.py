# streamlit_app.py
import sys
import os
from pathlib import Path
import streamlit as st

# –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞ –≤ sys.path
PROJECT_ROOT = Path(__file__).parent
sys.path.insert(0, str(PROJECT_ROOT))

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(
    page_title="–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤",
    page_icon="üí∞",
    layout="wide",
    initial_sidebar_state="expanded"
)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
try:
    from src.streamlit_app.main import main
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    if __name__ == "__main__":
        main()
        
except ImportError as e:
    st.error(f"–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π: {e}")
    st.info("–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ-–≤–µ—Ä—Å–∏—é
    st.title("üèóÔ∏è –°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤")
    st.subheader("–î–µ–º–æ-–≤–µ—Ä—Å–∏—è")
    
    st.markdown("""
    ### üìä –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
    - **–ê–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö —Ü–µ–Ω** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–Ω –ø–æ —Ç–æ–≤–∞—Ä–∞–º –∏ —Ä–∏—Ç–µ–π–ª–µ—Ä–∞–º
    - **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω** - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
    - **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –º–µ—Ç—Ä–∏–∫
    - **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö** - –≤—ã–≥—Ä—É–∑–∫–∞ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
    - **–î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤—ã–π –¥–æ—Å—Ç—É–ø** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤
    
    ### üöÄ –°—Ç–∞—Ç—É—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
    –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏. –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.
    """)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞
    with st.expander("üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞"):
        st.code("""
        competitor_pricing_app_v2/
        ‚îú‚îÄ‚îÄ src/
        ‚îÇ   ‚îú‚îÄ‚îÄ data_processing/
        ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ data_loader.py
        ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pricing_engine.py
        ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pipeline.py
        ‚îÇ   ‚îî‚îÄ‚îÄ streamlit_app/
        ‚îÇ       ‚îú‚îÄ‚îÄ main.py
        ‚îÇ       ‚îú‚îÄ‚îÄ auth.py
        ‚îÇ       ‚îú‚îÄ‚îÄ visualizations.py
        ‚îÇ       ‚îî‚îÄ‚îÄ analytics.py
        ‚îú‚îÄ‚îÄ data/
        ‚îÇ   ‚îú‚îÄ‚îÄ raw/
        ‚îÇ   ‚îú‚îÄ‚îÄ processed/
        ‚îÇ   ‚îî‚îÄ‚îÄ archive/
        ‚îú‚îÄ‚îÄ config/
        ‚îú‚îÄ‚îÄ docs/
        ‚îî‚îÄ‚îÄ requirements.txt
        """)
    
    # –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
    import pandas as pd
    import numpy as np
    import plotly.express as px
    
    st.subheader("üìà –î–µ–º–æ-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è")
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
    np.random.seed(42)
    demo_data = pd.DataFrame({
        '–¢–æ–≤–∞—Ä': [f'SKU_{i:03d}' for i in range(1, 21)],
        '–ù–∞—à–∞_—Ü–µ–Ω–∞': np.random.uniform(50, 200, 20),
        '–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç_1': np.random.uniform(45, 210, 20),
        '–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç_2': np.random.uniform(40, 220, 20),
        '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è_—Ü–µ–Ω–∞': np.random.uniform(48, 205, 20),
        '–ö–∞—Ç–µ–≥–æ—Ä–∏—è': np.random.choice(['–ú–æ–ª–æ—á–Ω—ã–µ', '–•–ª–µ–±', '–ú—è—Å–æ', '–û–≤–æ—â–∏'], 20)
    })
    
    # –ì—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ü–µ–Ω
    fig = px.scatter(
        demo_data, 
        x='–ù–∞—à–∞_—Ü–µ–Ω–∞', 
        y='–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è_—Ü–µ–Ω–∞',
        color='–ö–∞—Ç–µ–≥–æ—Ä–∏—è',
        title='–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã—Ö —Ü–µ–Ω',
        labels={'–ù–∞—à–∞_—Ü–µ–Ω–∞': '–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞', '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è_—Ü–µ–Ω–∞': '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Ü–µ–Ω–∞'}
    )
    st.plotly_chart(fig, use_container_width=True)
    
    # –¢–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö
    st.subheader("üìã –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ")
    st.dataframe(demo_data, use_container_width=True)
    
    st.info("üí° –≠—Ç–æ –¥–µ–º–æ-–≤–µ—Ä—Å–∏—è. –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.")
